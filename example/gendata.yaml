######
# Run: 
#   1. dorisdump gendata --dbs test_db --ddl fixture --rows 100 --genconf example/gendata.yaml -Ldebug
#   2. dorisdump gendata --dbs test    --ddl fixture --rows 100 --genconf example/gendata.yaml -Ldebug
######

# Default null frequency
# null_frequency: 0

# Default type generate rule
type:
  jsonb:
    # default structure of all jsonb (use MAP or ARRAY is OK too!)
    structure: 'struct<foo:bigint>'
    # do not gen NULL for jsonb itself
    null_frequency: 0
    fields:
      # range -1 to 1, 10% NULL
      - name: foo
        min: -1
        max: 1
        null_frequency: 0.1
  bigint:
    min: 0
    max: 100
  date:
    min: 1997-02-16
    max: 2025-06-12

tables:
  - name: employees
    row_count: 100 # optional, default 1000 (specify by --rows)
    columns:
      - name: department_id
        null_frequency: 1 # 100% NULL
      - name: salary
        min: "15000.00"
        max: "16000.00"
      - name: hire_date
        min: "1997-01-15"
        max: "1997-01-15"

  - name: all_type_nullable
    # row_count: 100
    columns:
      ### Basic ###
      - name: dt_month # varchar(6)
        length: 2
      - name: t_null_decimal_precision_38
        precision: 10
        scale: 3
        min: 100
        max: 102 # max is 102.999
      - name: t_null_string
        length:
          min: 20
          max: 30
        null_frequency: 0.1
      - name: datetime1
        min: "1997-01-15"
        max: "1997-01-15"


      ### Custom generator ###

      # inc generator
      - name: t_string
        gen:
          # All custom generators can have an optional result format
          # The grammer is same as golang's `fmt.Sprintf()`
          format: "string-inc-%d"
          # incrementing from 100 (default 0), step 2 (default 1)
          inc:
            start: 100
            step: 2

      # enum generator
      - name: t_null_string
        null_frequency: 0.5
        gen:
          format: "What's your name? My name is %s."
          enum: [foo, bar, foobar]
          weights: [20, 60, 20] # optional, the probabilities of being chosen

      # range generator
      - name: t_int
        gen:
          range: {min: 1997, max: 2097}

      # template generator
      - name: t_varchar2
        null_frequency: 0.5
        gen:
          # yes, format also support template grammar
          # TODO: see xxx for all template placeholders like '{{month}}'
          format: "year: %d, month: {{month}}"
          range: {min: 1997, max: 2097}

      # Finally, the golang generator
      - name: t_varchar
        gen:
          # Must have a function named `gen` in golang code
          golang: |
            import "fmt"

            var i int
            func gen() string {
                i++
                return fmt.Sprintf("Is odd: %v.", i%2 == 1)
            }


      ### Complex type ###
      - name: t_map_varchar # map<varchar(255),varchar(255)>
        key:
          gen:
            format: "key-%d"
            # default to start from 0
            inc:
        value:
          length: {min: 20, max: 50}

      - name: t_array_string # array<text>
        length: {min: 1, max: 10}
        element:
          # custom generatot for array element
          gen:
            values: [foo, bar, foobar]

      - name: t_struct_nested # struct<foo:text, struct_field:array<text>>
        fields:
          - name: foo
            length: 3
          - name: struct_field
            length: 10
            element:
              null_frequency: 0
              length: 2

      # JSON/JSONB/VARIANT
      - name: json1
        structure: |
          struct<
            c1: varchar(3),
            c2: struct<array_field: array<text>>, -- nested complex type (yes, you can write comment here)
            c3: boolean
          >
        fields:
          # length 1, 0% NULL
          - name: c1
            length: 1
            null_frequency: 0
          - name: c2 # struct<array_field: array<text>>>
            fields:
              - name: array_field
                length: 1
                element:
                  null_frequency: 0
                  length: 2

